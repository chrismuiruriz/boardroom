var boardroomApp=angular.module("boardroom",["ngRoute","ngSanitize"]);boardroomApp.config(function(b,a,c){b.when("/",{templateUrl:"src/views/home.html",controller:"homeController",resolve:{check:function(d){if(1==1){}else{d.path("/login/");alert("You don't have access here")}}}}).when("/cart/",{templateUrl:"src/views/cart.html",controller:"cartController",resolve:{check:function(d){if(1==1){}else{d.path("/");alert("You don't have access here")}}}}).when("/orders/",{templateUrl:"src/views/orders.html",controller:"ordersController",resolve:{check:function(d){if(1==1){}else{d.path("/");alert("You don't have access here")}}}}).when("/login/",{templateUrl:"src/views/login.html",controller:"loginController"}).when("/register/",{templateUrl:"src/views/register.html",controller:"registerController"}).when("/password/",{templateUrl:"src/views/password.html",controller:"passwordController"});a.html5Mode(false)});boardroomApp.controller("homeController",function(a,b){if(localStorage.userId){a.userTitleBar=localStorage.userName}else{location.href="#/login/"}a.hasDrinks=false;a.addToCart=function(h,f,g){var d=event.currentTarget;swal("Sending to cart...");swal.showLoading();var c={method:"POST",url:"http://mesmerizestudiokenya.com/boardroom/api/ios-addToCart.php",headers:{"Content-Type":undefined},data:{userId:localStorage.userId,productId:f,productQuantity:1,source:"OWNER"}};b(c).success(function(e){console.log(e);if(e.addToCartstatus=="SUCCESS"){swal({text:"1 "+g+" added to your cart.",timer:1500}).then(function(){},function(i){if(i==="timer"){console.log("I was closed by the timer")}})}else{swal({text:"Unknown Error! Try again.",timer:1500}).then(function(){},function(i){if(i==="timer"){console.log("I was closed by the timer")}})}}).error(function(){swal({text:"Internet Connection Error! Try again.",timer:1500}).then(function(){},function(e){if(e==="timer"){console.log("I was closed by the timer")}})})};a.getDrinksRequest=function(){var d="http://mesmerizestudiokenya.com/boardroom/api/ios-getDrinks.php";swal("Loading Drinks...");swal.showLoading();var c={method:"POST",url:d,headers:{"Content-Type":undefined},data:{userEmail:localStorage.userId}};a.drinks=[];b(c).success(function(e){console.log(e);swal.close();if(e!=null){a.drinks=e;if(e.length>=1){a.hasDrinks=true}}else{swal({title:"Unknown Error!",text:"Cannot Display Drinks.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({title:"Internet Connection Error!",text:"Cannot Display Drinks.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})};a.getDrinksRequest()});boardroomApp.controller("cartController",function(a,b){if(localStorage.userId){a.userTitleBar=localStorage.userName}else{location.href="#/login/"}a.hasCart=false;a.cartItems=[];a.totalAmountInCart="";a.showTotal=false;a.getTotalInCart=function(){var d=0;for(var c=0;c<a.cartItems.length;c++){var e=a.cartItems[c];d+=(e.productPrice*e.productQuantity)}a.totalAmountInCart=d;console.log("Total Amount: "+d)};a.getCartRequest=function(){var d="http://mesmerizestudiokenya.com/boardroom/api/ios-getCart.php";swal("Loading your cart...");swal.showLoading();var c={method:"POST",url:d,headers:{"Content-Type":undefined},data:{userId:localStorage.userId}};b(c).success(function(e){console.log(e);swal.close();if(e!==null){if(e.length>=1){a.hasCart=true;console.log("Empty!")}a.cartItems=e;a.showTotal=true;a.getTotalInCart()}else{swal({title:"Unknown Error!",text:"Cannot display your cart.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({title:"Internet Connection Error!",text:"Cannot display your cart.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})};a.getCartRequest();a.editItemRequest=function(e){var d="http://mesmerizestudiokenya.com/boardroom/api/ios-updateCart.php";swal("Updating...");swal.showLoading();var c={method:"POST",url:d,headers:{"Content-Type":undefined},data:{userId:localStorage.userId,cartId:a.itemCartId,productQuantity:a.itemEditQuantity}};b(c).success(function(f){swal.close();if(f.status==="SUCCESS"){a.getCartRequest();$("#editCartModal").rmodal("hide")}else{swal({text:"Unknown Error! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({text:"Server Error! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})};a.deleteItemRequest=function(c){swal({title:"Remove Item from Cart!",text:"Are you sure you want to remove this item from your cart?",type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, remove it!",cancelButtonText:"Nope!",closeOnConfirm:false,closeOnCancel:true}).then(function(f){if(f){var e="http://mesmerizestudiokenya.com/boardroom/api/ios-deleteCartItem.php";swal("Deleting...");swal.showLoading();var d={method:"POST",url:e,headers:{"Content-Type":undefined},data:{userId:localStorage.userId,cartId:a.itemCartId}};b(d).success(function(g){swal.close();if(g.status==="SUCCESS"){a.getCartRequest();$("#editCartModal").rmodal("hide")}else{swal({text:"Unknown Error! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({text:"Server Error! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})}},function(d){console.log(d)})};a.emptyCartRequest=function(c){swal({title:"Empty your Cart!",text:"Are you sure you want to empty this cart?",type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, empty it!",cancelButtonText:"Nope!",closeOnConfirm:false,closeOnCancel:true}).then(function(f){if(f){var e="http://mesmerizestudiokenya.com/boardroom/api/ios-emptyCart.php";swal("Clearing Your cart...");swal.showLoading();var d={method:"POST",url:e,headers:{"Content-Type":undefined},data:{userId:localStorage.userId,tempId:$(".temp-cart-id").val()}};b(d).success(function(g){swal.close();if(g.status==="SUCCESS"){a.getCartRequest();a.hasCart=false}else{swal({text:"Unknown Error1! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({text:"Server Error! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})}},function(d){console.log(d)})};a.confirmCartRequest=function(c){swal({title:"Submit your order?",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, submit it!",cancelButtonText:"Nope!",closeOnConfirm:false,closeOnCancel:true}).then(function(f){if(f){var e="http://mesmerizestudiokenya.com/boardroom/api/ios-submitOrder.php";swal("Sending...");swal.showLoading();var d={method:"POST",url:e,headers:{"Content-Type":undefined},data:{userId:localStorage.userId,tempId:$(".temp-cart-id").val()}};b(d).success(function(g){swal.close();if(g.status==="SUCCESS"){a.getCartRequest()}else{swal({text:"Unknown Error1! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({text:"Server Error! Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})}},function(d){console.log(d)})};a.editCart=function(e,h,d,c,g,f){a.itemCartId=h;a.itemEditName=d;a.itemEditPrice=g;a.itemEditQuantity=c;a.itemEditTotal=f;$("#editCartModal").rmodal("show")};a.closeCartModel=function(){$("#editCartModal").rmodal("hide")}});boardroomApp.controller("ordersController",function(a,c){a.orderTitle="TODAY'S ORDERS";if(localStorage.userId){a.userTitleBar=localStorage.userName}else{location.href="#/login/"}a.hasOrders=false;var b=new Pikaday({field:$("#date-from")[0],format:"DD/MM/YYYY",firstDay:1});var b=new Pikaday({field:$("#date-to")[0],format:"DD/MM/YYYY",firstDay:1});a.getOrderRequest=function(){var e="http://mesmerizestudiokenya.com/boardroom/api/ios-getOrders.php";swal("Fetching your orders...");swal.showLoading();var d={method:"POST",url:e,headers:{"Content-Type":undefined},data:{userId:localStorage.userId}};c(d).success(function(f){console.log(f);swal.close();if(f!==null){a.cartItems=f;a.showTotal=true;if(f.length>=1){a.hasOrders=true}}else{swal({title:"Unknown Error!",text:"Cannot display your orders.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({title:"Internet Connection Error!",text:"Cannot display your orders.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})};a.getOrderRequest();a.filterOrderRequest=function(f){var e="http://mesmerizestudiokenya.com/boardroom/api/ios-filterOrders.php";swal("Fetching your orders...");a.cartItems=[];swal.showLoading();var d={method:"POST",url:e,headers:{"Content-Type":undefined},data:{userId:localStorage.userId,filterFrom:a.dateFromInput,filterTo:a.dateToInput}};c(d).success(function(g){console.log(g);swal.close();if(g!==null){a.orderTitle=a.dateFromInput+" To "+a.dateToInput;a.cartItems=g;$("#filterOrderModal").rmodal("hide")}else{swal({title:"Unknown Error!",text:"Cannot display your orders.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){swal({title:"Internet Connection Error!",text:"Cannot display your orders.",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})})};a.openFilterModel=function(){$("#filterOrderModal").rmodal("show")};a.closeFilterModel=function(){$("#filterOrderModal").rmodal("hide")}});boardroomApp.controller("loginController",function(a,c,b){a.sidebarTitle="Top News";if(localStorage.userId){location.href="#/";return}if(sessionStorage.sessionUserEmail){a.email=sessionStorage.sessionUserEmail;a.pass=sessionStorage.sessionUserPass}a.loginRequest=function(f){var e="http://mesmerizestudiokenya.com/boardroom/api/ios-userLogin.php";swal("Please wait...");swal.showLoading();var d={method:"POST",url:e,headers:{"Content-Type":undefined},data:{userEmail:a.email,userPass:a.pass}};c(d).success(function(g){console.log(g);swal.showLoading();if(g.loginStatus==true){localStorage.userName=g.userFirstName;localStorage.userPhone=g.userPhone;localStorage.userId=g.userId;swal({title:"Login Successful!",text:"Welcom Back "+g.userFirstName,type:"success",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){location.href="#/"})}else{swal({title:"Invalid Details!",text:"Please Try Again!",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){console.log("Hello")})}});boardroomApp.controller("registerController",function(a,c,b){a.sidebarTitle="Top News";a.registerRequest=function(f){var e="http://mesmerizestudiokenya.com/boardroom/api/ios-userRegister.php";swal("Please wait...");swal.showLoading();var d={method:"POST",url:e,headers:{"Content-Type":undefined},data:{userFirstName:a.fname,userLastName:a.lname,userEmail:a.email,userPhone:a.phone,userCompany:a.company,userPass:a.pass1}};c(d).success(function(g){console.log(g);swal.hideLoading();if(g.registrationStatus==true){sessionStorage.sessionUserEmail=a.email;sessionStorage.sessionUserPass=a.pass;swal({title:"Registration Successful!",text:"Welcom to Boardroom",type:"success",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK");location.href="#/login"})}else{swal({title:"Registration Failed!",text:"Please Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){console.log("OK")})}}).error(function(){console.log("Hello")})}});boardroomApp.controller("passwordController",function(a,b){a.resetPassRequest=function(e){console.log("Email = "+a.emailPass);var d="http://mesmerizestudiokenya.com/boardroom/api/ios-resetPass.php";swal("Please wait...");swal.showLoading();var c={method:"POST",url:d,headers:{"Content-Type":undefined},data:{emailPass:a.emailPass}};b(c).success(function(f){console.log(f);swal.hideLoading();if(f.resetStatus==true){swal({title:"Password sent to your email",text:"Check your spam",type:"success",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){location.href="#/login"})}else{swal({title:"Email not found!",text:"Please Try Again",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){})}}).error(function(){swal({text:"Connection Error!",type:"warning",showCancelButton:false,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){})})}});boardroomApp.controller("profileController",function(a,d,b,c){a.sectionTitle=b.user_id;a.url="http://api.hivisasa.com/articles/county/nakuru/category/"+a.sectionTitle});